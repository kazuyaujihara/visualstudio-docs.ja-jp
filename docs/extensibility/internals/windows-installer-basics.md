---
title: Windows インストーラーの基本 |Microsoft Docs
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Windows Installer, VSPackages
- VSPackages, Windows Installer basics
ms.assetid: 497e479b-add8-4644-870a-917f15306b97
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 2a6e671b8b5a20d10624e8f89b601c23087237d2
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/22/2019
ms.locfileid: "72721509"
---
# <a name="windows-installer-basics"></a>Windows インストーラーの基本事項
Windows インストーラーは、ユーザーのコンピューターにアプリケーションまたはソフトウェア製品をインストールしてアンインストールし、これらのタスクを Windows インストーラーコンポーネント (WICs またはコンポーネントとも呼ばれます) と呼ばれる単位で実行します。 GUID は、各 WIC を識別します。これは、インストールの基本単位であり、Windows インストーラーを使用したセットアップの参照カウントです。

 Windows インストーラーの包括的なドキュメントについては、プラットフォーム SDK のトピック「 [Windows インストーラー](/previous-versions/2kt85ked(v=vs.120))」を参照してください。

## <a name="authoring-a-vspackage"></a>VSPackage を作成する
 Windows インストーラーではインストールパッケージが使用されます。これには、製品のインストール、アンインストール、修復、およびセットアップのユーザーインターフェイス (UI) の実行に必要 Windows インストーラー情報が含まれています。 各インストールパッケージには .msi ファイルが含まれています。このファイルには、インストールデータベース、概要情報ストリーム、およびインストールのさまざまな部分のデータストリームが含まれています。 インストーラーを使用するには、インストールを作成する必要があります。 インストーラーはコンポーネントの概念を中心としたインストールを整理し、インストールに関する情報をリレーショナルデータベースに格納するため、インストールパッケージを作成するプロセスには、次の手順が含まれます。

1. バージョン管理とサイドバイサイド方式をサポートするようにセットアップの作成を計画します。

2. ユーザーに提示する機能を特定します。

3. VSPackage と依存関係をコンポーネントに整理します。

4. インストールデータベースに情報を入力します。

5. インストールパッケージを検証します。

   このドキュメントでは、主にプロセスの最初と3番目の手順について説明します。 これらの手順では、VSPackage の機能を WICs に整理します。これにより、バージョン管理とサービスの戦略を調整して、[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] の後続バージョンを考慮することができます。 残りの3つの手順の詳細については、Platform SDK の Windows インストーラードキュメントを参照してください。

## <a name="key-terms"></a>主要条件
 次に、Windows インストーラーテクノロジに関連する主な用語の定義を示します。

 リソースファイル、レジストリキー、ショートカットなどがコンピューターにインストールされる場合があります。 これらのリソースは、論理的に Windows インストーラーコンポーネントにグループ化されます。

 Windows インストーラーコンポーネント (WIC) インストールされ、ユニットとしてアンインストールされた関連リソースの論理グループを表す、インストールの基本単位。 Windows インストーラーコンポーネントは、一意のコンポーネント ID (GUID) によって識別されます。 さらに、Windows インストーラーは、その参照カウントを WIC レベルで保持します。 バージョン管理の柔軟性を最大限に高めるには、特定の WIC に複数のプライマリリソース (DLL など) を含めないでください。 WIC を特定して設定し、それに GUID を付けて展開した後は、その構成を変更できないことに注意してください。 詳細については、「[コンポーネントへのアプリケーションの整理](/windows/desktop/Msi/organizing-applications-into-components)」を参照してください。

 パッケージ (Redist パッケージ) このファイルが指している可能性のある .msi ファイルと外部ソースファイルで構成される、展開の単位です。 パッケージには、UI を実行したり、アプリケーションをインストールまたはアンインストールしたりするために Windows インストーラー必要なすべての情報が含まれています。

 .msi ファイルアプリケーションをインストールするために必要な命令とデータを含む COM 構造化ストレージファイル。 すべてのパッケージには、少なくとも1つの .msi ファイルが含まれています。 .Msi ファイルには、インストーラーデータベース、概要情報ストリーム、および場合によっては1つ以上の変換と内部ソースファイルが含まれます。 インストールするファイルは、キャビネットに圧縮し、.msi ファイルのストリームに保存するか、またはソースメディアの .msi ファイルの外部に保存、圧縮、または圧縮解除することができます。 詳細については、「 [Windows インストーラーファイル拡張子](/windows/desktop/Msi/windows-installer-file-extensions)」を参照してください。

## <a name="windows-installer-rules-enforcement"></a>Windows インストーラールールの適用
 セットアップのコンポーネントによるリソースのデプロイは、2つのルールセットによって決定されます。 1つの規則セットは Windows インストーラー自体によって管理されますが、2番目のセットはインストール作成者として適用する必要があります。

> [!NOTE]
> Windows インストーラー規則の適用は、.msi ファイルの検証を実行する場合にのみ行われます。 ただし、これらのルールをベストプラクティスとして扱うのは cautioned です。 詳細については、「[インストールデータベース](/windows/desktop/Msi/validating-an-installation-database)と[パッケージの検証](/windows/desktop/Msi/package-validation)の検証」を参照してください。

#### <a name="installer-enforced-rules"></a>インストーラーで適用される規則

- 特定のコンポーネント内のすべてのファイルを同じディレクトリにインストールする必要があります。 逆に、別のフォルダーにインストールされるファイルは、個別のコンポーネントに属している必要があります。

- コンポーネントごとに1つのキーパスしか指定できません。 キーのパスは、単純に、コンポーネント全体を表すファイルまたはレジストリキーです。

#### <a name="component-provider-responsibilities"></a>コンポーネントプロバイダーの責任

- 後続のバージョンで個別に出荷される可能性のある2つのリソースは、別々のコンポーネントに存在する必要があります。 リソースを同じコンポーネントにグループ化する必要があるのは、これらのリソースが個別に出荷されることがないことがわかっている場合のみです。 実際には、すべてのプライマリリソース (Dll など) は、常に個別の WICs に存在することをお勧めします。 詳細については、「[インストーラーコンポーネントの定義](/windows/desktop/Msi/defining-installer-components)」を参照してください。

- バージョン管理されたリソースを複数の WIC に発送することはできません。

## <a name="see-also"></a>関連項目
- [コンポーネントルールが壊れている場合はどうなりますか。](/windows/desktop/Msi/what-happens-if-the-component-rules-are-broken)