---
title: テンプレートディレクトリの説明 (.Vsdir ファイル |Microsoft Docs
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- .vsdir files
- VSDIR files
- template directory description files
ms.assetid: 9df51800-190e-4662-b685-fdaafcff1400
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: fb20a1fbc8d5edd9783521fa933dbddc74ac2a22
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/22/2019
ms.locfileid: "72722824"
---
# <a name="template-directory-description-vsdir-files"></a>テンプレート ディレクトリの説明 (.Vsdir) ファイル
テンプレートディレクトリ記述ファイル (.vsdir) は、統合開発環境 (IDE: integrated development environment) が、プロジェクトに関連付けられているフォルダー、ウィザード .vsz ファイル、およびテンプレートファイルをダイアログボックスに表示できるようにするテキストファイルです。 コンテンツには、ファイルまたはフォルダーごとに1つのレコードが含まれます。 参照先の場所にあるすべての .vsdir ファイルはマージされますが、複数のフォルダー、ウィザード、またはテンプレートファイルを記述するために通常提供されるのは1つの .vsdir ファイルだけです。

 フォルダー (サブディレクトリ)、.vsdir ファイルで参照されるファイル、および .vsdir ファイル自体がすべて同じディレクトリに配置されます。 IDE でウィザードを実行するか、 **[新しいプロジェクト]** ダイアログボックスまたは **[新しい項目の追加]** ダイアログボックスにフォルダーまたはファイルを表示すると、実行したファイルが含まれているディレクトリが調べられ、.vsdir ファイルが存在するかどうかが判断されます。 .Vsdir ファイルが見つかった場合、IDE はそれを読み取って、実行された、または表示されているフォルダーまたはファイルのエントリが含まれているかどうかを判断します。 エントリが見つかった場合、IDE はウィザードの実行またはコンテンツの表示に関する情報を使用します。

 次のコード例は、\<EnvSDK > \BscPrj\BscPrj\BscPrjProjectItems\Source_Files レジストリキーの SourceFiles ファイルに含まれています。

```
HeaderFile.h|{E59935A1-6156-11d1-87A6-00A0C91E2A46}|#125|130|#126|0|0|0|#127
SourceFile.cpp|{E59935A1-6156-11d1-87A6-00A0C91E2A46}|#122|110|#123|0|0|0|#124
```

 この場合、2つのレコードが1つのファイルに含まれます。 新しい行 (キャリッジリターン文字) によって各レコードが区切られます。 各行は異なるファイルの種類を表します。 パイプ (&#124;) 文字は、各レコードのフィールドを区切ります。 1つのディレクトリに、異なるファイル名を持つ複数の .vsdir ファイルを含めることができます。また、ファイルの種類ごとに1つの .vsdir ファイルを使用することもできます。

## <a name="fields"></a>フィールド
 次の表に、各レコードに対して指定されているフィールドを示します。

| フィールド | 説明 |
| - | - |
| 相対パス名 (RelPathName) | フォルダー、テンプレート、または .vsz ファイルの名前 (HeaderFile、MyWizard、.vsz など)。 このフィールドは、フォルダーを表すために使用される名前にすることもできます。 |
| {clsidPackage} | VSPackage のサテライトダイナミックリンクライブラリ (DLL) リソースで、ローカライズされた文字列 (LocalizedName、Description、IconResourceId、SuggestedBaseName など) へのアクセスを可能にする VSPackage の GUID。 DLLPath が指定されていない場合、IconResourceId が適用されます。 **注:** 前のフィールドの1つ以上がリソース識別子の場合を除き、このフィールドは省略可能です。 このフィールドは通常、テキストをローカライズしないサードパーティのウィザードに対応する .vsdir ファイルに対しては空白になります。 |
| LocalizedName | テンプレートファイルまたはテンプレートウィザードのローカライズされた名前。 このフィールドには、文字列または "#ResID" 形式のリソース識別子を指定できます。 この名前は、 **[新しい項目の追加]** ダイアログボックスに表示されます。 **注:** LocalizedName がリソース識別子の場合は、{clsidPackage} が必要です。 |
| SortPriority | このテンプレートファイルまたはウィザードの相対的な優先順位を表す整数。 たとえば、この項目の値が1の場合、この項目は、並べ替え値が2以上のすべての項目の値が1で前になる他の項目の横に表示されます。<br /><br /> 並べ替えの優先順位は、同じディレクトリ内の項目に対して相対的です。 同じディレクトリに複数の vsdir ファイルがある可能性があります。 この場合、すべての項目が含ま<em>れます。</em>そのディレクトリ内の vsdir ファイルがマージされます。 同じ優先順位の項目は、表示名の大文字小文字を区別しない辞書順に一覧表示されます。 @No__t_0 関数は、項目の順序付けに使用されます。<br /><br /> .Vsdir ファイルに記述されていない項目には、.vsdir ファイルに記載されている最も高い優先順位よりも大きい優先順位番号が含まれます。 結果として、これらの項目は、名前に関係なく、表示されている一覧の末尾にあります。 |
| 説明 | テンプレートファイルまたはテンプレートウィザードのローカライズされた説明。 このフィールドには、文字列または "#ResID" 形式のリソース識別子を指定できます。 この文字列は、項目が選択されたときに **[新しいプロジェクト]** ダイアログボックスまたは **[新しい項目の追加]** ダイアログボックスに表示されます。 |
| DLLPath または {clsidPackage} | テンプレートファイルまたはウィザードのアイコンを読み込むために使用します。 アイコンは、IconResourceId を使用して .dll または .exe ファイルからリソースとして読み込まれます。 この .dll または .exe ファイルは、完全パスを使用するか、VSPackage の GUID を使用して識別できます。 VSPackage の実装 DLL は、(サテライト DLL ではなく) アイコンを読み込むために使用されます。 |
| IconResourceId | 表示するアイコンを決定する DLL または VSPackage の実装 DLL 内のリソース識別子。 |
| フラグ (<xref:Microsoft.VisualStudio.Shell.Interop.__VSDIRFLAGS>) | **[新しい項目の追加]** ダイアログボックスの **[名前]** フィールドと **[場所]** フィールドを無効または有効にするために使用します。 **Flags**フィールドの値は、必要なビットフラグの組み合わせに相当する10進数です。<br /><br /> ユーザーが **新規** タブで項目を選択すると、**新しい項目の追加** ダイアログボックスが最初に表示されたときに、名前 フィールドと 場所 フィールドが表示されるかどうかがプロジェクトによって決定されます。 項目は、.vsdir ファイルを介して、項目が選択されている場合に、フィールドが有効か無効かを制御できます。 |
| SuggestedBaseName | ファイル、ウィザード、またはテンプレートの既定の名前を表します。 このフィールドは、文字列または "#ResID" 形式のリソース識別子のいずれかです。 IDE では、この値を使用して項目の既定の名前を指定します。 この基本値には、MyFile21 などの名前が一意になるように、整数値が付加されます。<br /><br /> 前の一覧では、Description、DLLPath、IconResourceId、Flags、および SuggestedBaseNumber がテンプレートおよびウィザードファイルにのみ適用されます。 これらのフィールドは、フォルダーには適用されません。 この事実は、\<EnvSDK > \BscPrj\BscPrj\BscPrjProjectItems レジストリキーの BscPrjProjectItems ファイルのコードに示されています。 このファイルには、各レコードについて、RelPathName、{clsidPackage}、LocalizedName、および SortPriority の4つのフィールドを持つ3つのレコードが含まれています。<br /><br /> `General&#124;{E59935A1-6156-11d1-87A6-00A0C91E2A46}&#124;#110&#124;100`<br /><br /> `Source_Files&#124;{E59935A1-6156-11d1-87A6-00A0C91E2A46}&#124;#111&#124;110`<br /><br /> `Env&#124;{E59935A1-6156-11d1-87A6-00A0C91E2A46}&#124;#112&#124;120` |

 ウィザードファイルを作成する場合は、次の問題についても考慮する必要があります。

- 意味のあるデータを持たない省略可能なフィールドには、プレースホルダーとして 0 (ゼロ) を格納する必要があります。

- ローカライズされた名前が指定されていない場合は、ウィザードファイルで相対パス名が使用されます。

- DLLPath は、アイコンの場所に対して clsidPackage をオーバーライドします。

- アイコンが定義されていない場合は、その拡張子を持つファイルの既定のアイコンが IDE によって置き換えられます。

- 推奨されるベース名が指定されていない場合は、' Project ' が使用されます。

- .Vsz ファイル、フォルダー、またはテンプレートファイルを削除する場合は、関連付けられているレコードも .vsdir ファイルから削除する必要があります。

## <a name="see-also"></a>関連項目
- [ウィザード](../../extensibility/internals/wizards.md)
- [ウィザード (.Vsz) ファイル](../../extensibility/internals/wizard-dot-vsz-file.md)