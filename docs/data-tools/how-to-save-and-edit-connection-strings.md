---
title: '方法: 接続文字列を保存および編集する'
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: f8ef3a2c-029c-423b-9d9e-a4f1add4f640
author: jillre
ms.author: jillfra
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: a78194ae6e4f462ec732e1ae2a1981aa8d857978
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/19/2019
ms.locfileid: "72641798"
---
# <a name="how-to-save-and-edit-connection-strings"></a>方法: 接続文字列を保存および編集する
Visual Studio アプリケーションの接続文字列は、アプリケーション構成ファイル (アプリケーション設定とも呼ばれます) に保存されるか、アプリケーションに直接ハードコーディングされます。 接続文字列をアプリケーション構成ファイルに保存すると、アプリケーションの保守作業が簡単になります。 接続文字列を変更する必要がある場合は、アプリケーション設定ファイルで接続文字列を更新できます (ソース コードで変更してアプリケーションをコンパイルし直す必要はありません)。

接続文字列内に機密情報 (パスワードなど) を格納すると、アプリケーションのセキュリティに影響を及ぼすことがあります。 アプリケーション構成ファイルに保存された接続文字列は暗号化も難読化もされないため、第三者がファイルにアクセスしてコンテンツを表示する可能性があります。 データベースへのアクセスを制御する方法としては、Windows 統合セキュリティを使用する方が安全です。

Windows 統合セキュリティを使用しない環境で、データベースにユーザー名とパスワードが必要な場合、接続文字列からユーザー名とパスワードを削除できます。ただし、データベースに正常に接続するには、この情報をアプリケーションから提供する必要があります。 たとえば、ユーザーにこの情報を要求するダイアログ ボックスを作成し、実行時に接続文字列を動的にビルドできます。 この方法でも、情報がデータベースに送信される途中で傍受された場合は、セキュリティの問題が発生する可能性があります。
詳細については、「[接続情報の保護](/dotnet/framework/data/adonet/protecting-connection-information)」を参照してください。

## <a name="to-save-a-connection-string-from-within-the-data-source-configuration-wizard"></a>データソース構成ウィザード内から接続文字列を保存するには
**データソース構成ウィザード**で、 **[アプリケーション構成ファイルに接続文字列を保存]** ページで接続を保存するオプションを選択します。

## <a name="to-save-a-connection-string-directly-into-application-settings"></a>接続文字列をアプリケーション設定に直接保存するには
1. **ソリューション エクスプローラーで**、 **[My Project]** アイコン (Visual Basic) または **[プロパティ]** アイコン (C#) をダブルクリックして、**プロジェクト デザイナー**を開きます。
1. **[設定]** タブを選択します。
1. **[名前]** に接続文字列の名前を入力します。 コードで接続文字列にアクセスするときにこの名前を参照します。
1. **[種類]** を **[接続文字列]** に設定します。
1. **[スコープ]** を **[アプリケーション]** のままにします。
1. **値** フィールドに接続文字列を入力するか、**値** フィールドの**省略記号**ボタン (...) をクリックして **接続プロパティ** ダイアログボックスを開き、接続文字列を作成します。

## <a name="edit-connection-strings-stored-in-application-settings"></a>アプリケーション設定に格納されている接続文字列の編集
アプリケーション設定に保存されている接続情報は、**プロジェクト デザイナー**を使用して変更できます。

### <a name="to-edit-a-connection-string-stored-in-application-settings"></a>アプリケーション設定に格納された接続文字列を編集するには
1. **ソリューション エクスプローラーで**、 **[My Project]** アイコン (Visual Basic) または **[プロパティ]** アイコン (C#) をダブルクリックして、**プロジェクト デザイナー**を開きます。
1. **[設定]** タブを選択します。
1. 編集する接続を見つけて、 **[値]** フィールドのテキストを選択します。
1. **値** フィールドの接続文字列を編集するか、**値** フィールドの**省略記号**ボタン (...) をクリックして、**接続プロパティ** ダイアログボックスで接続を編集します。

## <a name="edit-connection-strings-for-datasets"></a>データセットの接続文字列の編集
データセット内の各 TableAdapter の接続情報を変更できます。

### <a name="to-edit-a-connection-string-for-a-tableadapter-in-a-dataset"></a>データセット内の TableAdapter の接続文字列を編集するには
1. **ソリューションエクスプローラー**で、編集する接続が含まれているデータセット ( **.xsd**ファイル) をダブルクリックします。
1. 編集する接続が含まれている**TableAdapter**またはクエリを選択します。
1. **[プロパティ]** ウィンドウで、[**接続] ノード**を展開します。
1. 接続文字列をすばやく変更するには、 **ConnectionString**プロパティを編集するか、**接続**プロパティの下矢印をクリックして **[新しい接続]** を選択します。

## <a name="security"></a>セキュリティ
接続文字列内に機密情報 (パスワードなど) を格納すると、アプリケーションのセキュリティに影響を及ぼすことがあります。 データベースへのアクセスを制御する方法としては、Windows 統合セキュリティを使用する方が安全です。
詳細については、「[接続情報の保護](/dotnet/framework/data/adonet/protecting-connection-information)」を参照してください。

## <a name="see-also"></a>関連項目

- [接続の追加](../data-tools/add-new-connections.md)