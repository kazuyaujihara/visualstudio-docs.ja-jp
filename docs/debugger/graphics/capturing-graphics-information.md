---
title: グラフィックス情報のキャプチャ |Microsoft Docs
ms.date: 02/09/2017
ms.topic: conceptual
f1_keywords:
- vs.graphics.frame
- vs.graphics.capturewindow
- VS.ToolsOptionsPages.Graphics_Diagnostics.Capture
ms.assetid: 187ce86e-e340-4f6c-8937-8e8f1027a17f
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: b38dd994eca30bfee071f00431f3b111c2ea444a
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/22/2019
ms.locfileid: "72736167"
---
# <a name="capturing-graphics-information"></a>グラフィックス情報をキャプチャする
Visual Studio Graphics Analyzer を使用してレンダリングに関する問題とパフォーマンスに関する問題を診断できるように、Direct3D アプリからグラフィックス情報をキャプチャします。

## <a name="capturing-graphics-information"></a>グラフィックス情報をキャプチャする
 グラフィックス情報のキャプチャは 2 段階のプロセスです。 最初に、アプリをグラフィックス診断の下で実行し、詳細情報をキャプチャする 1 つ以上のフレームを指定します。

### <a name="to-run-your-app-under-graphics-diagnostics"></a>グラフィックス診断の下でアプリを実行するには

- メニューバーで、 **[デバッグ]** 、 **[グラフィックス]** 、 **[グラフィックスデバッグの開始]** の順に選択します。 (キーボード: Alt キーを押しながら F5 キーを押します)

- **[グラフィックス]** ツールバーで、 **[グラフィックスデバッグの開始]** ボタンをクリックします。

  アプリがグラフィックス診断の下で実行されている間、特定の種類のグラフィックス情報が常にキャプチャされます。これには、デバイス セットアップ、スワップ チェーンの作成、グラフィックス オブジェクトとリソースの作成、および複数のフレームに影響するその他の重要なイベントが含まれます。 同時に、特定のフレームに関する詳細情報をキャプチャできます。これには、描画の呼び出しおよび計算シェーダーのディスパッチと、これらをサポートする Direct3D オブジェクトおよびリソースが含まれます。

### <a name="to-capture-a-frame"></a>フレームをキャプチャするには

- Visual Studio の **[グラフィックス]** ツールバーで、 **[フレームのキャプチャ]** ボタンの [![グラフィックスキャプチャ] ボタンアイコン](media/debuggingdirectxgraphics.png "DebuggingDirectXGraphics")をクリックします。

- キーボードの Printscreen キーを押します。

  > [!NOTE]
  > アプリケーションが **[グラフィックス診断]** で実行されている間、PrintScreen キーはグラフィックス情報のフレームをキャプチャするためだけに使用できます。通常の機能は実行できません。 これは、デバッグを停止するかアプリケーションを正常に終了して、グラフィックス情報のキャプチャを停止するまで有効です。別のアプリケーションにフォーカスがある場合でも同じです。

- Visual Studio キャプチャ インターフェイスで、 **[診断セッション]** タイムラインの下にある **[フレームのキャプチャ]** ボタンを選択するか、 **[1 秒あたりのフレーム数]** スイム レーンの下、または以前にキャプチャされたフレームの右側にある大きな **[フレームのキャプチャ]** ボタンを選択します。 下の画像では、両方のボタンが強調表示されています。

   ![GPU 使用率ツールを使用してフレームをキャプチャする。](media/pix_gpu_usage_tool_capture_frame.png)

   キャプチャしたフレームを確認する準備ができたら、サムネイル画像の上の **[フレーム]** リンクに従って、またはサムネイルをダブルクリックして、**Visual Studio Graphics Analyzer** を起動します。

  フレーム全体のみをキャプチャできます。そのため、キャプチャを開始したときに実際に記録されるのは、次のフレームのグラフィックス情報です。 記録は、キャプチャを開始したフレームが表示された直後に開始され、キャプチャするフレームが表示されると終了します。 アプリがグラフィックス診断の下で実行されている間、フレームを必要なだけキャプチャできます。 どのフレームもキャプチャしない場合、グラフィックス ログは破棄されます。

  フレームをキャプチャするときに、Visual Studio では診断セッション (.diagsession) ウィンドウが表示されます。 このウィンドウを閉じるか、デバッグを停止するか、アプリを閉じると、それ以上フレームをそのログにキャプチャできなくなります。 より多くのグラフィックス情報をキャプチャするには、グラフィックス診断の下で再度アプリを実行し、新しい診断セッションを開始する必要があります。

### <a name="graphics-diagnostics-capture-options"></a>グラフィックス診断のキャプチャ オプション
 キャプチャを構成して、すべてのグラフィックス イベントまたは特定のサブセットの呼び出し履歴の収集、キャプチャの HUD の無効化、およびキャプチャ互換モードの有効化または無効化を行うことができます。

#### <a name="to-configure-graphics-diagnostics-capture-options"></a>グラフィックス診断のキャプチャ オプションを構成するには

1. メニュー バーで [ツール]、[オプション] の順にクリックします。 [オプション] ダイアログ ボックスが表示されます。

2. 左側にあるオプション カテゴリの一覧からグラフィックス診断を選択した後、使用するグラフィックス診断オプションを構成します。

     **キャプチャ中に呼び出し履歴を収集する (キャプチャ速度が低下)** 呼び出し履歴を収集するには、このチェックボックスをオンにします。 既定では、呼び出し履歴は収集されません。 呼び出し履歴を取得するには、 **[呼び出し履歴をキャプチャ中に収集する (キャプチャ速度が低下します)]** チェック ボックスで収集を有効にするよう設定し、 **[描画、ディスパッチ、表示、およびパフォーマンス マーカー]** オプション (既定) を設定して最も重要な呼び出し履歴のみを収集するか、 **[すべて]** オプションを設定してすべての呼び出し履歴を収集します。 後で呼び出し履歴の収集を停止するには、 **[呼び出し履歴をキャプチャ中に収集する (キャプチャ速度が低下します)]** チェック ボックスをクリアします。

     **キャプチャ中にゲーム内の HUD を無効にする**グラフィックス診断の下で実行されているアプリが通常表示する HUD オーバーレイを無効にするには、このチェックボックスをオンにします。 HUD オーバーレイを表示するには、このチェック ボックスをオフにします。

     **互換モードでキャプチャ**するグラフィックス情報を互換モードでキャプチャするには、このチェックボックスをオンにします。 互換モードでのキャプチャが既定の動作です。 互換モードでは、Direct3D は、基本機能レベルで定義されていない追加機能が GPU でサポートされることを報告しません。 このため、アプリをキャプチャしている GPU のハードウェア固有の拡張機能が、キャプチャ中のアプリで使用されなくなり、同じまたはそれ以上の機能レベルをサポートしている任意の GPU を使用して、グラフィックス ログを再生できるようになります。 互換モードを無効にするには、このチェック ボックスをオフにします。互換モードでキャプチャされたログは、キャプチャ中にアプリで使用されたものと同じ追加機能をサポートしていない GPU 上では再生できません。

     **SDK レイヤーエラーが検出された場合にキャプチャを停止する**エラーが発生した場合、すぐにキャプチャを停止するには、このチェックボックスをオンにします。

## <a name="capturing-graphics-information-remotely"></a>グラフィックス情報をリモートでキャプチャする
 グラフィックス情報は、ローカル コンピューターか、リモート コンピューターまたはリモート デバイスで実行されているアプリからキャプチャできます。 リモート キャプチャは、[!INCLUDE[winblue_client_2](../includes/winblue_client_2_md.md)] コンピューターと [!INCLUDE[winblue_winrt_2](../includes/winblue_winrt_2_md.md)] デバイスでサポートされています。 リモートで実行されているアプリからグラフィックス情報をキャプチャするには、リモート デバッグ用にプロジェクトを構成し、既に説明したように、グラフィックス診断の下でアプリを実行します。 アプリがリモート コンピューターで実行され、キャプチャされたグラフィックス情報が開発用コンピューターに記録されます。

 プロジェクトをリモート デバッグ用に構成する方法は、開発中のアプリの種類と、使用しているプログラミング言語によって異なります。 UWP アプリのリモートデバッグを構成する方法の詳細については、「[リモートコンピューターでの uwp アプリの実行](../run-windows-store-apps-on-a-remote-machine.md)」を参照してください。 Windows デスクトップアプリのリモートデバッグを構成する方法の詳細については、「[リモートデバッグ](../remote-debugging.md)」を参照してください。

 後で、情報をキャプチャした場所にかかわらず、リモート コンピューターまたはリモート デバイスを使用してグラフィックス情報を再生できます。 詳しくは、「[方法: グラフィックス診断再生マシンを変更する](how-to-change-the-graphics-diagnostics-playback-machine.md)」をご覧ください。

## <a name="capturing-graphics-information-from-the-command-line"></a>コマンド ラインからのグラフィックス情報のキャプチャ
 コマンド ライン ツールを使用して、アプリからグラフィックス情報をキャプチャできます。 この DXCap.exe というツールでは、Visual Studio またはプログラムによるキャプチャを使用することなく、簡単にグラフィックス情報をキャプチャして再生できます。 具体的には、オートメーションを行う場合や、テスト環境で DXCap.exe を使用できます。 DXCap.exe の詳細については、「[コマンド ライン キャプチャ ツール](command-line-capture-tool.md)」を参照してください。

## <a name="see-also"></a>関連項目
- [チュートリアル: グラフィックス情報のキャプチャ](walkthrough-capturing-graphics-information.md)